const transactions = [
  {
    _id: "66a3849e49ad18363cedf6fa",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Settle",
    total_cost: 50,
    paid_by: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    split: [
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 50,
        _id: "66a3849e49ad18363cedf6fb",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "settle",
    createdAt: "2024-07-26T11:12:30.774Z",
    updatedAt: "2024-07-26T11:12:30.774Z",
    __v: 0,
  },
  {
    _id: "66a3848e49ad18363cedf6ed",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Chair",
    total_cost: 20,
    paid_by: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 0,
        _id: "66a3848e49ad18363cedf6ee",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 0,
        _id: "66a3848e49ad18363cedf6ef",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 20,
        _id: "66a3848e49ad18363cedf6f0",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T11:12:14.905Z",
    updatedAt: "2024-07-26T11:12:14.905Z",
    __v: 0,
  },
  {
    _id: "66a3836b49ad18363cedf681",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "TV",
    total_cost: 103,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 34.34,
        _id: "66a3836b49ad18363cedf682",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 34.33,
        _id: "66a3836b49ad18363cedf683",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 34.33,
        _id: "66a3836b49ad18363cedf684",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T11:07:23.153Z",
    updatedAt: "2024-07-26T11:07:23.153Z",
    __v: 0,
  },
  {
    _id: "66a38275ffa69877d9d8e8c4",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "TV",
    total_cost: 103,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 34.34,
        _id: "66a38275ffa69877d9d8e8c5",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 34.33,
        _id: "66a38275ffa69877d9d8e8c6",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 34.33,
        _id: "66a38275ffa69877d9d8e8c7",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T11:03:17.020Z",
    updatedAt: "2024-07-26T11:03:17.020Z",
    __v: 0,
  },
  {
    _id: "66a381b8c9149fb93faf32bf",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "TV",
    total_cost: 103,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 34.34,
        _id: "66a381b8c9149fb93faf32c0",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 34.33,
        _id: "66a381b8c9149fb93faf32c1",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 34.33,
        _id: "66a381b8c9149fb93faf32c2",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T11:00:08.319Z",
    updatedAt: "2024-07-26T11:00:08.319Z",
    __v: 0,
  },
  {
    _id: "66a380e28f6542b4799f0853",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "TV",
    total_cost: 100,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 33.34,
        _id: "66a380e28f6542b4799f0854",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 33.33,
        _id: "66a380e28f6542b4799f0855",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 33.33,
        _id: "66a380e28f6542b4799f0856",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T10:56:34.539Z",
    updatedAt: "2024-07-26T10:56:34.539Z",
    __v: 0,
  },
  {
    _id: "66a380b0ba9416f80f9b77c7",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "TV",
    total_cost: 100,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 33.34,
        _id: "66a380b0ba9416f80f9b77c8",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 33.33,
        _id: "66a380b0ba9416f80f9b77c9",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 33.33,
        _id: "66a380b0ba9416f80f9b77ca",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T10:55:44.861Z",
    updatedAt: "2024-07-26T10:55:44.861Z",
    __v: 0,
  },
  {
    _id: "66a37f7c8dfd5484613d310b",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Hello",
    total_cost: 65,
    paid_by: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 21.66,
        _id: "66a37f7c8dfd5484613d310c",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 21.67,
        _id: "66a37f7c8dfd5484613d310d",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 21.67,
        _id: "66a37f7c8dfd5484613d310e",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T10:50:36.489Z",
    updatedAt: "2024-07-26T10:50:36.489Z",
    __v: 0,
  },
  {
    _id: "66a37ec48dfd5484613d3092",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Rent",
    total_cost: 200,
    paid_by: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 66.66,
        _id: "66a37ec48dfd5484613d3093",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 66.67,
        _id: "66a37ec48dfd5484613d3094",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 66.67,
        _id: "66a37ec48dfd5484613d3095",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T10:47:32.566Z",
    updatedAt: "2024-07-26T10:47:32.566Z",
    __v: 0,
  },
  {
    _id: "66a37ddd8dfd5484613d3058",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Food",
    total_cost: 120,
    paid_by: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    split: [
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 40,
        _id: "66a37ddd8dfd5484613d3059",
      },
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 40,
        _id: "66a37ddd8dfd5484613d305a",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 40,
        _id: "66a37ddd8dfd5484613d305b",
      },
    ],
    createdBy: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    type: "transaction",
    createdAt: "2024-07-26T10:43:41.554Z",
    updatedAt: "2024-07-26T10:43:41.554Z",
    __v: 0,
  },
  {
    _id: "669e777cffa9c9873cea6265",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Third Transaction yay",
    total_cost: 150,
    paid_by: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    split: [
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 50,
        _id: "669e777cffa9c9873cea6266",
      },
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 50,
        _id: "669e777cffa9c9873cea6267",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 50,
        _id: "669e777cffa9c9873cea6268",
      },
    ],
    createdBy: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    createdAt: "2024-07-22T15:15:08.112Z",
    updatedAt: "2024-07-22T15:15:08.112Z",
    __v: 0,
    type: "transaction",
  },
  {
    _id: "669e7714ffa9c9873cea6260",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "Second Transaction yay",
    total_cost: 100,
    paid_by: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    split: [
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 50,
        _id: "669e7714ffa9c9873cea6261",
      },
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 50,
        _id: "669e7714ffa9c9873cea6262",
      },
    ],
    createdBy: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    createdAt: "2024-07-22T15:13:24.306Z",
    updatedAt: "2024-07-22T15:13:24.306Z",
    __v: 0,
    type: "transaction",
  },
  {
    _id: "669e662effa9c9873cea625a",
    group: "669e5e6042ad69dd16cc520d",
    transaction_name: "First Transaction yay",
    total_cost: 102.6,
    paid_by: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    split: [
      {
        user: {
          _id: "669e3018b3a5ab995cb02a0f",
          email: "amrutesharun051299@gmail.com",
          full_name: "Amaru",
          username: "amaru333",
        },
        amount: 33.6,
        _id: "669e662effa9c9873cea625b",
      },
      {
        user: {
          _id: "669e25606ea9d4a9133e9637",
          email: "amrutesharun0599@gmail.com",
          full_name: "Amrutesh Arun",
          username: "amaru.exe",
        },
        amount: 33,
        _id: "669e662effa9c9873cea625c",
      },
      {
        user: {
          _id: "669e366b028987d25a9dd639",
          email: "amrutesharun0512992223232323232@gmail.com",
          full_name: "Another User",
          username: "anotheruser",
        },
        amount: 36,
        _id: "669e662effa9c9873cea625d",
      },
    ],
    createdBy: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    createdAt: "2024-07-22T14:01:18.689Z",
    updatedAt: "2024-07-22T14:01:18.689Z",
    __v: 0,
    type: "transaction",
  },
];

const splitGroupBalances = (data) => {
  const splitBalances = [];
  data?.forEach((transactionItem) => {
    const indexOfElement = splitBalances.findIndex((element) => element.user._id.toString() === transactionItem.paid_by._id.toString());
    if (indexOfElement === -1) {
      splitBalances.push({
        user: transactionItem.paid_by,
        amount: transactionItem.total_cost,
      });
    } else {
      splitBalances[indexOfElement].amount += transactionItem.total_cost;
    }
    transactionItem.split.forEach((splitItem) => {
      const splitIndex = splitBalances.findIndex((element) => element.user._id.toString() === splitItem.user._id.toString());
      if (splitIndex === -1) {
        splitBalances.push({
          user: splitItem.user,
          amount: -splitItem.amount,
        });
      } else {
        splitBalances[splitIndex].amount -= splitItem.amount;
      }
    });
  });

  splitBalances.forEach((splitItem) => {
    splitItem.amount = parseFloat(splitItem.amount.toFixed(2));
  });

  return splitBalances;
};

console.log(splitGroupBalances(transactions));

[
  {
    user: {
      _id: "669e25606ea9d4a9133e9637",
      email: "amrutesharun0599@gmail.com",
      full_name: "Amrutesh Arun",
      username: "amaru.exe",
    },
    amount: -116.02,
  },
  {
    user: {
      _id: "669e366b028987d25a9dd639",
      email: "amrutesharun0512992223232323232@gmail.com",
      full_name: "Another User",
      username: "anotheruser",
    },
    amount: 205.01,
  },
  {
    user: {
      _id: "669e3018b3a5ab995cb02a0f",
      email: "amrutesharun051299@gmail.com",
      full_name: "Amaru",
      username: "amaru333",
    },
    amount: -108.99,
  },
];
